<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio 3D</title>

    <!-- THREE.JS (última versión CDN oficial) -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/three@latest/build/three.module.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/three@latest/examples/jsm/loaders/GLTFLoader.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/three@latest/examples/jsm/loaders/RGBELoader.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/three@latest/examples/jsm/controls/OrbitControls.js"></script>

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #111;
            color: #fff;
        }

        header {
            position: sticky;
            top: 0;
            background: #000;
            padding: 15px 0;
            text-align: center;
            z-index: 1000;
        }

        header a {
            margin: 0 20px;
            color: white;
            text-decoration: none;
            font-weight: bold;
        }

        .gallery {
            display: flex;
            gap: 20px;
            padding: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .thumb {
            width: 160px;
            height: 160px;
            background: #222;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #333;
            transition: 0.2s;
        }

        .thumb:hover {
            border: 2px solid #fff;
            transform: scale(1.05);
        }

        #viewer-container {
            width: 100%;
            height: 500px;
            background: #000;
        }

        footer {
            position: sticky;
            bottom: 0;
            background: #000;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #333;
        }

        footer p {
            opacity: 0.7;
        }
    </style>
</head>
<body>

<header>
    <a href="#">Home</a>
    <a href="#gallery">3D</a>
    <a href="#contact">Contact</a>
</header>

<section id="gallery">
    <h2 style="text-align:center;">Modelos 3D</h2>

    <div class="gallery">
        <div class="thumb" onclick="loadModel('compressed_Bull_Char_blended.glb')">Modelo 1</div>
        <div class="thumb" onclick="loadModel('modelo2.glb')">Modelo 2</div>
        <div class="thumb" onclick="loadModel('modelo3.glb')">Modelo 3</div>
    </div>

    <div id="viewer-container"></div>
</section>

<footer id="contact">
    <h3>Contact</h3>
    <p>Mis redes sociales aquí</p>
</footer>

<!-- SCRIPT DEL VIEWER -->
<script type="module">
    import * as THREE from "https://cdn.jsdelivr.net/npm/three@latest/build/three.module.js";
    import { GLTFLoader } from "https://cdn.jsdelivr.net/npm/three@latest/examples/jsm/loaders/GLTFLoader.js";
    import { RGBELoader } from "https://cdn.jsdelivr.net/npm/three@latest/examples/jsm/loaders/RGBELoader.js";
    import { OrbitControls } from "https://cdn.jsdelivr.net/npm/three@latest/examples/jsm/controls/OrbitControls.js";

    let scene, camera, renderer, controls, currentModel;

    const container = document.getElementById("viewer-container");

    function initViewer() {
        if (!renderer) {
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.outputEncoding = THREE.sRGBEncoding;
            container.appendChild(renderer.domElement);
        }

        scene = new THREE.Scene();

        camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.set(3, 2, 5);

        controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 2;

        new RGBELoader()
            .setPath("assets/")
            .load("studio_small_03_1k.hdr", function (texture) {
                texture.mapping = THREE.EquirectangularReflectionMapping;
                scene.environment = texture;
            });

        animate();
    }

    function loadModel(name) {
        const loader = new GLTFLoader();

        if (currentModel) {
            scene.remove(currentModel);
            currentModel = null;
        }

        loader.load(
            `assets/models/${name}`,
            gltf => {
                currentModel = gltf.scene;
                scene.add(currentModel);

                currentModel.rotation.y = Math.PI;

                const box = new THREE.Box3().setFromObject(currentModel);
                const size = box.getSize(new THREE.Vector3()).length();
                const center = box.getCenter(new THREE.Vector3());

                currentModel.position.x += (currentModel.position.x - center.x);
                currentModel.position.y += (currentModel.position.y - center.y);
                currentModel.position.z += (currentModel.position.z - center.z);

                camera.position.set(size, size, size);
                controls.update();
            },
            undefined,
            err => console.error("Error cargando modelo:", err)
        );
    }

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
    }

    initViewer();
</script>

</body>
</html>
